<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=resizes-content"
    />
    <meta name="description" content="Parallel agentic development with Electron + React" />
    <meta name="theme-color" content="#1e1e1e" />
    <link rel="manifest" href="/manifest.json" crossorigin="use-credentials" vite-ignore />
    <link rel="icon" href="/favicon.ico" data-theme-icon vite-ignore />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" vite-ignore />
    <title>mux - coder multiplexer</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: var(--color-background, #1e1e1e);
        color: var(--color-foreground, #d4d4d4);
        font-family: var(
          --font-primary,
          -apple-system,
          BlinkMacSystemFont,
          "Geist",
          system-ui,
          "Segoe UI",
          "Roboto",
          "Helvetica Neue",
          Arial,
          sans-serif,
          "Apple Color Emoji",
          "Segoe UI Emoji",
          "Segoe UI Symbol"
        );
        font-size: 14px;
      }

      :root[data-theme="light"] body {
        background: #f5f6f8;
      }

      #root {
        height: 100vh; /* fallback for older browsers */
        height: 100dvh;
        overflow: hidden;
      }

      /* Pre-JS placeholder to avoid a blank screen on cold start. */
      .boot-loader {
        height: 100vh; /* fallback for older browsers */
        height: 100dvh;
        width: 100vw;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .boot-loader__inner {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
      }

      .boot-loader__logo {
        width: 200px;
        height: auto;
        color: var(--color-foreground, #d4d4d4);
      }

      :root[data-theme="light"] .boot-loader__logo,
      :root[data-theme$="-light"] .boot-loader__logo {
        color: var(--color-foreground, #1e1e1e);
      }

      .boot-loader__text {
        margin: 0;
        font-size: 14px;
        color: var(--color-text-secondary, #6b6b6b);
      }

      :root[data-theme="light"] .boot-loader__text,
      :root[data-theme$="-light"] .boot-loader__text {
        color: var(--color-text-secondary, #607081);
      }

      /* Animated "..." after the loading text. Uses ::after so it works in
         both the static HTML boot loader and the React LoadingScreen. */
      @keyframes boot-ellipsis {
        0%, 20%  { content: ""; }
        40%      { content: "."; }
        60%      { content: ".."; }
        80%, 100% { content: "..."; }
      }

      .boot-loader__dots {
        display: inline-block;
        width: 1.5ch;
        text-align: left;
      }

      .boot-loader__dots::after {
        content: "";
        animation: boot-ellipsis 1.2s steps(1) infinite;
      }

      @media (prefers-reduced-motion: reduce) {
        .boot-loader__dots::after {
          content: "...";
          animation: none;
        }
      }
    </style>
    <script>
      (function () {
        const THEME_KEY = "uiTheme";
        const VALID_THEMES = new Set(["light", "dark", "flexoki-light", "flexoki-dark"]);

        const THEME_COLORS = {
          dark: "#1e1e1e",
          light: "#f5f6f8",
          "flexoki-light": "#fffcf0",
          "flexoki-dark": "#100f0f",
        };

        function getColorScheme(theme) {
          return theme === "light" || theme.endsWith("-light") ? "light" : "dark";
        }

        try {
          const stored = window.localStorage.getItem(THEME_KEY);
          let parsed = null;

          // Tolerate legacy values that were written as raw strings (not JSON).
          if (stored) {
            try {
              parsed = JSON.parse(stored);
            } catch {
              parsed = stored;
            }
          }

          const prefersLight = window.matchMedia
            ? window.matchMedia("(prefers-color-scheme: light)").matches
            : false;

          const fallbackTheme = prefersLight ? "light" : "dark";
          let theme = fallbackTheme;

          if (typeof parsed === "string") {
            if (VALID_THEMES.has(parsed)) {
              theme = parsed;
            } else if (parsed.endsWith("-light")) {
              theme = "light";
            } else if (parsed.endsWith("-dark")) {
              theme = "dark";
            }
          }

          const colorScheme = getColorScheme(theme);

          document.documentElement.dataset.theme = theme;
          document.documentElement.style.colorScheme = colorScheme;

          const metaThemeColor = document.querySelector('meta[name="theme-color"]');
          if (metaThemeColor) {
            metaThemeColor.setAttribute(
              "content",
              THEME_COLORS[theme] ?? THEME_COLORS[colorScheme] ?? "#1e1e1e"
            );
          }
        } catch (error) {
          console.warn("Failed to apply preferred theme early", error);
          document.documentElement.dataset.theme = "dark";
          document.documentElement.style.colorScheme = "dark";
        }
      })();
    </script>
  </head>
  <body>
    <div id="root">
      <div class="boot-loader" role="status" aria-live="polite" aria-busy="true">
        <div class="boot-loader__inner">
          <svg class="boot-loader__logo" aria-hidden="true" viewBox="0 0 135 62" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path
    d="M3.168 48V22.272H9.648L9.888 28.464L9.216 28.176C9.568 26.8 10.096 25.632 10.8 24.672C11.536 23.712 12.416 22.976 13.44 22.464C14.464 21.952 15.584 21.696 16.8 21.696C18.944 21.696 20.672 22.32 21.984 23.568C23.328 24.816 24.192 26.496 24.576 28.608L23.664 28.656C23.952 27.152 24.448 25.888 25.152 24.864C25.888 23.808 26.784 23.024 27.84 22.512C28.896 21.968 30.08 21.696 31.392 21.696C33.184 21.696 34.72 22.064 36 22.8C37.28 23.536 38.272 24.64 38.976 26.112C39.68 27.552 40.032 29.328 40.032 31.44V48H32.832V33.456C32.832 31.44 32.528 29.936 31.92 28.944C31.312 27.92 30.32 27.408 28.944 27.408C28.08 27.408 27.344 27.648 26.736 28.128C26.128 28.608 25.648 29.312 25.296 30.24C24.976 31.136 24.816 32.24 24.816 33.552V48H18.336V33.552C18.336 31.568 18.048 30.048 17.472 28.992C16.896 27.936 15.904 27.408 14.496 27.408C13.632 27.408 12.88 27.648 12.24 28.128C11.632 28.608 11.168 29.312 10.848 30.24C10.528 31.168 10.368 32.272 10.368 33.552V48H3.168ZM54.2254 48.576C51.5694 48.576 49.4894 47.728 47.9854 46.032C46.5134 44.304 45.7774 41.904 45.7774 38.832V22.272H52.9774V37.152C52.9774 39.136 53.2814 40.592 53.8894 41.52C54.4974 42.416 55.4574 42.864 56.7694 42.864C58.2414 42.864 59.3774 42.368 60.1774 41.376C61.0094 40.352 61.4254 38.832 61.4254 36.816V22.272H68.6254V48H62.0494L61.8574 40.608L62.7694 40.8C62.3854 43.36 61.4734 45.296 60.0334 46.608C58.5934 47.92 56.6574 48.576 54.2254 48.576ZM72.8486 48L82.0166 34.944L73.0886 22.272H80.7206L86.2406 30.528L91.5686 22.272H99.3926L90.5126 34.992L99.6326 48H92.0006L86.3366 39.264L80.6246 48H72.8486Z"
    fill="currentColor"
  />
  <rect x="109" y="13" width="26" height="35" fill="currentColor" />
</svg>
          <p class="boot-loader__text">Loading Mux<span class="boot-loader__dots"></span></p>
        </div>
      </div>
    </div>
    <script type="module" src="/src/browser/main.tsx"></script>
  </body>
</html>
